<head>
	<!DOCTYPE html>
	<meta charset="utf-8">
	<meta name="viewport" content="initial-scale=1.0" />
	<!-- <link rel="stylesheet" href="style.css"> -->
	<title>channelArchive.py</title>
</head>

<body>
	<header>
		<h1>channelArchive.py</h1>
		<h1>Web Interface</h1>
		<button onclick="start()">Start Download</button>
		<button onclick="clearScreen()">Clear</button>
		<button onclick="toggleAdvanced()">Advanced</button>
		<div id="advancedOptions">
			<br>
			<button onclick="reloadServerConfiguration()">Reload .config</button>
			<br><br>
			<button onclick="fetchSessionHistory()">Session History</button>
		</div>
	</header>
	<br>
	<div id="output"></div>
</body>

<!-- SocketIO -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.1.3/socket.io.js"></script>

<script type="text/javascript">
	//Kicks off the download process
	var socket = io.connect();
	socket.on('connect', function () {
		console.log('Connected to the server');
	});
	socket.on('response', function (data) {
		console.log('Server says: ' + data);
		document.getElementById('output').innerHTML += data + '<br>\n<hr>';
	});

	function start() {
		this.clearScreen();
		socket.emit('startDownload');
	}

	function reloadServerConfiguration() {
		this.clearScreen();
		socket.emit('reloadConfiguration');
	}

	function clearScreen() {
		document.getElementById('output').innerHTML = '';
	}

	function toggleAdvanced() {
		var element = document.getElementById('advancedOptions');
		if (element.style.display === "block") {
			element.style.display = "none";
		} else {
			element.style.display = "block";
		}
	}

	//Fetch the messages from the current session
	//Useful after reloading the page after refresh or to get the status of previous download
	function fetchSessionHistory() {
		this.clearScreen();
		socket.emit('fetchSessionHistory')
	}
</script>

<style>
	body {
		margin: 10px auto;
		max-width: 650px;
		line-height: 1.6;
		font-size: 16px;
		color: #444;
		padding: 0 5px;
	}

	h1,
	h2,
	h3,
	header {
		line-height: 1.0;
		text-align: center;
	}

	button {
		color: #444;
		font-size: 16px;
	}

	#advancedOptions {
		display: none;
	}

	#output {
		text-align: justify;
	}
</style>